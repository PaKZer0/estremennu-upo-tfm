# Clone repo with training data

steps:
  # Step 1: Clone the phrases git repository
  - name: 'gcr.io/cloud-builders/git'
    args: ['clone', 'https://github.com/PaKZer0/recursos_es-ext.git', 'source']
  
  # Step 2: Clone this git repository
  - name: 'gcr.io/cloud-builders/git'
    args: ['clone', 'https://github.com/PaKZer0/estremennu-upo-tfm.git', 'code']
  
  # Step 3: Remove unnecesary files, translate and bundle texts
  - name: 'node:lts'
    entrypoint: 'bash'
    args:
      - '-c'
      - |
        # remove unnecesary files
        rm source/contenido-completo.es.txt
        rm source/contenido-completo.ext.txt

        # build script
        cd code/cloud_build/cb_translate
        npm i

        # for each file run translate function
        find ../../source/ -type f -name "*.es.txt" | while read -r file; do
            # Echo the file name
            echo "$file"
        done

  # Step 4: Push contents to Cloud Storage bucket
  #- name: 'gcr.io/cloud-builders/gsutil'
  #  args: ['cp', '-r', 'source/*', 'gs://estremennu-test-bucket/training-data/']
